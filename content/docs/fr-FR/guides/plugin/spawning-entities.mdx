---
title: Faire Apparaître des Entités
description: Apprenez à faire apparaître des entités dans Hytale
authors:
  - name: Neil Revin
    link: https://itsneil.dev
---

Dans ce guide, vous apprendrez comment faire apparaître des entités dans Hytale. Il est **fortement recommandé** de vous familiariser avec le système de composants d'entité (ECS) avant de poursuivre ce guide. Vous pouvez trouver le guide ECS [ici](./ecs).

## Obtenir l'Objet World

Vous devez d'abord obtenir l'objet `World` avant de procéder à l'apparition d'entités. Vous pouvez obtenir cet objet de plusieurs façons :

### Utiliser l'Objet `Player`

Vous pouvez utiliser l'objet `Player` pour obtenir l'objet `World` en appelant la méthode `getWorld()` sur l'instance `Player`.

```java
World world = player.getWorld();
```

### Utiliser la Classe `Universe`

Vous pouvez utiliser la classe `Universe` pour obtenir l'objet `World` en appelant la méthode `getWorld(string UUID)` sur l'instance `Universe`.

```java
World world = Universe.get().getWorld("your-world-uuid");
```

Une fois que vous avez l'objet world, vous devez obtenir une instance de `Store<EntityStore>`, vous pouvez le faire ainsi :

```java
Store<EntityStore> store = world.getEntityStore().getStore();
```

## Créer des Entités

Une fois que vous avez l'instance `EntityStore`, vous pouvez commencer à créer une entité et lui donner des composants. Les entités ne sont que des instances de `Holder<EntityStore>` avec plusieurs composants attachés.

<Callout type="warning">
  Pour utiliser la variable `store` que nous avons obtenue ci-dessus, nous devons exécuter ceci à l'intérieur du world. Vous pouvez le faire en utilisant la méthode `world.execute()` :

  ```java
  world.execute(() -> {
      // exécutez tout le code ci-dessous dans ce contexte
  })
  ```
</Callout>

Commençons par créer un holder vide :

```java
Holder<EntityStore> holder = EntityStore.REGISTRY.newHolder();
```

## Obtenir un Modèle

Vous avez maintenant besoin d'un modèle pour votre entité. Vous pouvez trouver une liste de toutes les entités [ici](../../server/entities), nous allons utiliser l'entité Minecart pour cet exemple :

```java
ModelAsset modelAsset = ModelAsset.getAssetMap().getAsset("Minecart");
Model model = Model.createScaledModel(modelAsset, 1.0f);
```

### Le Composant Transform

Le `TransformComponent` est le composant qui indique à Hytale où placer votre entité, quelle est sa localisation. Vous pouvez l'obtenir de plusieurs façons.

1. Obtenir le Transform Component depuis l'objet `Player`

```java
TransformComponent transform = store.getComponent(context.senderAsPlayerRef(), EntityModule.get().getTransformComponentType());
```

2. Générer un nouveau TransformComponent

```java
Vector3d vector3d = new Vector3d(0, 0, 0); // position
Vector3f vector3f = new Vector3f(0, 0, 0); // rotation
TransformComponent transform = new TransformComponent(vector3d, vector3f);
```

## Ajouter des Composants à notre Entité

Maintenant nous devons ajouter tous les composants que nous avons créés ci-dessus à notre entité, voici tous les composants que nous devons ajouter un par un :

```java

holder.addComponent(TransformComponent.getComponentType(), new TransformComponent(vector3d, new Vector3f(0, 0, 0)));
holder.addComponent(PersistentModel.getComponentType(), new PersistentModel(model.toReference()));
holder.addComponent(ModelComponent.getComponentType(), new ModelComponent(model));
holder.addComponent(BoundingBox.getComponentType(), new BoundingBox(model.getBoundingBox()));
holder.addComponent(NetworkId.getComponentType(), new NetworkId(store.getExternalData().takeNextNetworkId()));
holder.addComponent(Interactions.getComponentType(), new Interactions()); // you need to add interactions here if you want your entity to be interactable
```

### S'assurer que les Composants de Hytale sont présents

Ceux-ci agissent comme des composants de "configuration" ou "par défaut" que Hytale s'attend à trouver sur toutes les entités.

```java
holder.ensureComponent(UUIDComponent.getComponentType());
holder.ensureComponent(Interactable.getComponentType()); // if you want your entity to be interactable
```

## Faire Apparaître l'Entité

Enfin, nous pouvons faire apparaître l'entité dans le monde en appelant la méthode `spawnEntity` sur l'instance `EntityStore` :

```java
store.spawnEntity(holder, AddReason.SPAWN);
```
