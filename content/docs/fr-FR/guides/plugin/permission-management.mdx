---
title: Gestion des Permissions
description: Apprenez à gérer les nœuds de permission et les groupes dans votre plugin Hytale.
authors:
  - name: Neil Revin
    link: https://itsneil.dev
  - name: Bird
    link: https://discord.com/users/495709580068651009
  - name: Craw
    link: https://discord.com/users/292656109939064833
---

Dans ce guide, vous apprendrez comment gérer les nœuds de permission et les groupes dans votre plugin Hytale.

## La classe `PermissionsModule`

La classe `PermissionsModule` est responsable de la gestion des nœuds de permission et des groupes dans votre plugin. Elle fournit des méthodes pour vérifier, accorder et révoquer des permissions et des groupes pour les joueurs. Elle permet les opérations suivantes :

- Ajouter des permissions à un utilisateur
- Retirer des permissions d'un utilisateur
- Ajouter des permissions à un groupe (cela crée également le groupe s'il n'existe pas)
- Retirer des permissions d'un groupe
- Ajouter un utilisateur à un groupe
- Retirer un utilisateur d'un groupe
- Lister tous les groupes d'un utilisateur
- Vérifier si un utilisateur possède une permission (vérifie à la fois les permissions de l'utilisateur et du groupe pour l'UUID du joueur donné)

Avec cette classe, vous ne pouvez pas :

- Lister tous les groupes définis
- Supprimer un groupe

### Ajouter des Nœuds de Permission

Vous avez besoin d'un `Set<String>` contenant tous les nœuds de permission que vous souhaitez ajouter. Ceux-ci sont ajoutés en plus des nœuds de permission déjà existants que l'utilisateur peut avoir, ce n'est pas un remplacement.

```java
Set<String> permissions = new HashSet<>();
PermissionsModule perms = PermissionsModule.get();
perms.addUserPermission(playerUUID, permissions);
```

### Retirer des Nœuds de Permission

Comme ci-dessus, nous utilisons simplement la méthode `removeUserPermission` à la place pour retirer des nœuds de permission.

```java
Set<String> permissions = new HashSet<>();
PermissionsModule perms = PermissionsModule.get();
perms.removeUserPermission(playerUUID, permissions);
```

### Ajouter des permissions à un groupe

```java
String groupName = "testGroup";
Set<String> permissions = new HashSet<>();
PermissionsModule perms = PermissionsModule.get();
perms.addGroupPermission(groupName, permissions);
```

### Retirer des permissions d'un groupe

```java
String groupName = "testGroup";
Set<String> permissions = new HashSet<>();
PermissionsModule perms = PermissionsModule.get();
perms.removeGroupPermission(groupName, permissions);
```

### Ajouter un utilisateur à un groupe

```java
String groupName = "testGroup";
Set<String> permissions = new HashSet<>();
PermissionsModule perms = PermissionsModule.get();
perms.addUserToGroup(playerUUID, groupName);
```

### Retirer un utilisateur d'un groupe

```java
String groupName = "testGroup";
Set<String> permissions = new HashSet<>();
PermissionsModule perms = PermissionsModule.get();
perms.removeUserFromGroup(playerUUID, groupName);
```

### Lister tous les groupes d'un utilisateur

```java
PermissionsModule perms = PermissionsModule.get();
perms.getGroupsForUser(playerUUID);
```

### Vérifier les Nœuds de Permission

Pour vérifier si un joueur possède un nœud de permission spécifique, vous pouvez utiliser la méthode `hasPermission`.

```java
boolean hasPermission = PermissionsModule.hasPermission(playerUUID, "permission.node");
```

### Supplément : Définir votre propre fournisseur de stockage pour les permissions et les groupes

Apparemment, nous pourrions implémenter notre propre fournisseur de stockage pour les permissions et les groupes car le stockage de fichiers n'est pas très fiable.

Tout d'abord, nous devons définir une classe de fournisseur qui implémente PermissionProvider :

```java
public class DatabasePermissionProvider implements PermissionProvider
```

Ensuite, nous implémentons simplement les méthodes requises en utilisant une implémentation de base de données. Pour forcer notre plugin à utiliser ce nouveau fournisseur, nous devons simplement ajouter notre nouveau DatabasePermissionProvider à la liste des fournisseurs.

```java
perms.getProviders().addFirst(new DatabasePermissionProvider());
```
